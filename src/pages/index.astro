---
import Container from "../components/container";
import HeroPost from "../components/hero-post";
import Intro from "../components/intro.astro";
import Layout from "../components/layout";
import MoreStories from "../components/more-stories";
import getHome from "../operations/queries/getHome";
import useFetch from "../lib/useFetch";

const endpoint = "https://graphql.datocms.com/";
const response = await useFetch(endpoint, getHome);
const parsedResponse = await response.json();
const posts = parsedResponse.data.allPosts;
const heroPost = posts.shift();
const morePosts = posts;
---

<>
  <Layout preview={false} currentSlug={""}>
    <Container>
      <Intro />
      <HeroPost
        preview={false}
        title={heroPost.title}
        coverImage={heroPost.coverImage}
        date={heroPost.date}
        author={heroPost.author}
        slug={heroPost.slug}
        excerpt={heroPost.excerpt}
      />
      <MoreStories preview={false} posts={morePosts} />
    </Container>
  </Layout>
</>
